var sas=window.sas||{};sas.banner=sas.banner||{},sas.creativeType={REDIRECT:0,IMAGE:1,FLASH:2,FLV:3,HTML5:4},function(){var e={};sas.events.addEvent(window,"message",function(a){if(a.data&&e[a.data]){var t={clickUrls:e[a.data].clickUrlArray,isSmart:!0};a.source.postMessage(JSON.stringify(t),"*")}});var a=function(e,a,t){var i=document.createElement("iframe");return i.id=e,i.name=e+"_name",i.scrolling="no",i.frameBorder=0,i.width=a,i.height=t,i.style.margin=0,i.style.padding=0,i.style.width=a+"px",i.style.height=t+"px",i},t=function(e,a){if(!a)return!1;var t=document.createElement("div");t.innerHTML="_"+a;for(var i=1;i<t.childNodes.length;){var r=t.childNodes[i];if("SCRIPT"===r.tagName){var n=document.createElement("script");n.type="text/javascript",n.defer="defer",r.src?n.src=r.src:n.text=r.text,r=n,i++}e.appendChild(r)}};sas.utils=sas.utils||{},sas.utils.getIEVersion=function(){var e=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);return e?parseInt(e[1]):void 0};var i=function(e,a){var t=document.createElement("img"),i=t,r=parseInt(e.pixelRatio)||1;if(sas.events.addLoadEvent(t,function(){a(t)}),t.id=e.id,t.src=e.url,t.alt=e.altText,t.width=e.width/r,t.height=e.height/r,t.border=0,e.clickUrl){var n=document.createElement("a");n.href=e.clickUrl,n.target=e.clickTarget,n.appendChild(t),i=n}return i},r=[];sas.events.addLoadEvent(document,function(){window._loaded=!0,r.push=function(e){e()};for(var e=0;e<r.length;e++)r[e]()});var n=function(e,a){var t,i,n,s={id:e.id+"Object",height:e.height,width:e.width},d={quality:"high",allowScriptAccess:"always",wmode:e.wMode||"window",swLiveConnect:!0,flashVars:e.flashVars||""};for(var c in sas.utils.getIEVersion()<11?((n=document.createElement("div")).innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" type="application/x-shockwave-flash"><param name="movie" value="'+e.url+'"><param name="wmode" value="'+d.wmode+'"><param name="flashVars" value="'+d.flashVars+'"></object>',t=n.firstChild,delete d.wmode,delete d.flashVars,sas.events.addLoadEvent(t,function(){a(t)})):(t=document.createElement("object"),s.type="application/x-shockwave-flash",s.data=e.url,null!=(i=function(){a(t)})&&r.push(i)),s)t[c]=s[c];for(var o in d)if(d[o]){var l=document.createElement("param");l.name=o,l.value=d[o],t.appendChild(l)}return t},s={};s[sas.creativeType.REDIRECT]=function(e,t,i,r){var n=t.creatives[0];if(r.async){var s=a("sas_"+t.id+"_iframe",n.width,n.height);sas.events.addLoadEvent(s,function(){i(s)}),e.appendChild(s);var d=s.contentDocument||s.contentWindow.document;d.write('<body style="margin:0;padding:0"><script type="text/javascript">var inDapIF=inDapMgrIf=true;<\/script>'+n.creativeScript+t.customScript+"</body>");var c=sas.utils.getIEVersion();(!c||c>9)&&d.close()}else document.write(n.creativeScript+t.customScript)},s[sas.creativeType.IMAGE]=function(e,a,r){var n=a.creatives[0],s=i(n,r);e.appendChild(s),t(e,n.creativeScript+a.customScript)},s[sas.creativeType.FLASH]=function(e,a,r){var s=a.creatives[0],d=s.version&&s.version<=sas.Browser.Flash.version;if(d||s.backupImage&&s.backupImage.url){var c=d?n(s,r):i(s.backupImage,r);e.appendChild(c),t(e,s.creativeScript+a.customScript)}},s[sas.creativeType.HTML5]=function(e,i,r){for(var n=i.creatives[0],s="",d=0;d<n.clickUrlArray.length;d++)s+=0===d?"&clicktag="+encodeURIComponent(n.clickUrlArray[d]):"&clicktag"+(d+1)+"="+encodeURIComponent(n.clickUrlArray[d]);var c=n.url+(n.url.indexOf("?")<0?"?":"&")+"sasfid="+i.id+s,o=a("sas_"+i.id+"_iframe",n.width,n.height);o.src=c,sas.events.addLoadEvent(o,function(){r(o)}),e.appendChild(o),t(e,n.creativeScript+i.customScript)};var d=function(e,a,t){var i=new sas.utils.Latch(["creaLoaded","viewabilityLoaded"]),r={};r[a.creatives[0].id]={viewable:[a.viewability.viewUrl],notviewable:[],undetermined:[a.viewability.errorUrl]},sas.utils.loadScriptCdn("diff/templates/ts/dist/viewability/sas-viewability-1.0.js",{onLoad:function(){(new window.Viewability).init(e,r,{}),i.notify("viewabilityLoaded")}});var n=a.creatives[0];s[n.type](e,a,function(e){i.notify("creaLoaded",e)},t),n.countUrl&&((new Image).src=n.countUrl),a.oba&&function(e){var a=parseInt(1e8*Math.random()),t=2===e.oba?"top-left":"top-right";sas.utils.loadLinkCdn("diff/templates/js/adplayer/adplayer.css"),sas.utils.loadScriptCdn(["diff/templates/js/adplayer/adplayer.js","diff/templates/js/adplayer/adplayer.sas.js"],{onLoad:function(){$ADP.sas.addOba(e.formatId,!1,t,a,e.formatId,a)}})}(a)};sas.banner.render=function(t,i){if((i=i||{}).async=null==i.async||i.async,!t.creatives||!t.creatives.length)throw new Error("No creative found for config "+t.id);var r=t.creatives[0];t.tagId=function(e){var a=e.instanceIndex>1?"_"+e.instanceIndex:"";return e.tagId||"sas_"+e.formatId+a}(t),e[t.id]=r;var n=document.getElementById(t.tagId);if(!n)throw new Error("No element with id "+t.tagId+" found");if(r&&!s[r.type])throw new Error("Unsupported banner type "+r.type);if(t.forcedIframeWidth>0&&t.forcedIframeHeight>0){var c=a("sas_i"+t.tagId,t.forcedIframeWidth,t.forcedIframeHeight);sas.events.addLoadEvent(c,function(){var e=c.contentDocument||c.contentWindow.document;e.body.style.margin=0,e.body.style.padding=0,d(e.body,t,i)}),n.appendChild(c)}else d(n,t,i)}}();