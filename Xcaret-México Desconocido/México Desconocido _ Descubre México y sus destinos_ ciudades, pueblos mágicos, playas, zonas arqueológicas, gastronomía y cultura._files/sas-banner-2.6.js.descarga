var sas=window.sas||{};sas.banner=sas.banner||{},sas.creativeType={REDIRECT:0,IMAGE:1,FLASH:2,FLV:3,HTML5:4},function(){var e={};sas.events.addEvent(window,"message",function(a){if(a.data&&e[a.data]){var t={clickUrls:e[a.data].clickUrlArray,isSmart:!0};a.source.postMessage(JSON.stringify(t),"*")}});var a=function(e,a,t){var i=document.createElement("iframe");return i.id=e,i.name=e+"_name",i.scrolling="no",i.frameBorder=0,i.width=a,i.height=t,i.style.margin=0,i.style.padding=0,i.style.width=a+"px",i.style.height=t+"px",i},t=function(e,a){if(!a)return!1;var t=document.createElement("div");t.innerHTML="_"+a;for(var i=1;i<t.childNodes.length;){var r=t.childNodes[i];if("SCRIPT"===r.tagName){var n=document.createElement("script");n.type="text/javascript",n.defer="defer",r.src?n.src=r.src:n.text=r.text,r=n,i++}e.appendChild(r)}},i=function(e){var a=e.instanceIndex>1?"_"+e.instanceIndex:"";return e.tagId||"sas_"+e.formatId+a},r=function(e,i,r){for(var n=i.creatives[0],s="",d=0;d<n.clickUrlArray.length;d++)s+=0===d?"&clicktag="+encodeURIComponent(n.clickUrlArray[d]):"&clicktag"+(d+1)+"="+encodeURIComponent(n.clickUrlArray[d]);var c=n.url+(n.url.indexOf("?")<0?"?":"&")+"sasfid="+i.id+s,o=a("sas_"+i.id+"_iframe",n.width,n.height);o.src=c,sas.events.addLoadEvent(o,function(){r(o)}),e.appendChild(o),t(e,n.creativeScript+i.customScript)},n=function(e,t,i,r){var n=t.creatives[0];if(r.async){var s=a("sas_"+t.id+"_iframe",n.width,n.height);sas.events.addLoadEvent(s,function(){i(s)}),e.appendChild(s);var d=s.contentDocument||s.contentWindow.document;d.write('<body style="margin:0;padding:0"><script type="text/javascript">var inDapIF=inDapMgrIf=true;<\/script>'+n.creativeScript+t.customScript+"</body>");var c=sas.utils.getIEVersion();(!c||c>9)&&d.close()}else document.write(n.creativeScript+t.customScript)};sas.utils=sas.utils||{},sas.utils.getIEVersion=function(){var e=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);return e?parseInt(e[1]):void 0};var s=function(e,a){var t=document.createElement("img"),i=t,r=parseInt(e.pixelRatio)||1;if(sas.events.addLoadEvent(t,function(){a(t)}),t.id=e.id,t.src=e.url,t.alt=e.altText,t.width=e.width/r,t.height=e.height/r,t.border=0,e.clickUrl){var n=document.createElement("a");n.href=e.clickUrl,n.target=e.clickTarget,n.appendChild(t),i=n}return i},d=[],c=function(e){null!=e&&d.push(e)};sas.events.addLoadEvent(document,function(){window._loaded=!0,d.push=function(e){e()};for(var e=0;e<d.length;e++)d[e]()});var o=function(e,a){var t,i={id:e.id+"Object",height:e.height,width:e.width},r={quality:"high",allowScriptAccess:"always",wmode:e.wMode||"window",swLiveConnect:!0,flashVars:e.flashVars||""};sas.utils.getIEVersion()<11?(t=function(){var a=document.createElement("div");return a.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" type="application/x-shockwave-flash"><param name="movie" value="'+e.url+'"><param name="wmode" value="'+r.wmode+'"><param name="flashVars" value="'+r.flashVars+'"></object>',a.firstChild}(),delete r.wmode,delete r.flashVars,sas.events.addLoadEvent(t,function(){a(t)})):(t=document.createElement("object"),i.type="application/x-shockwave-flash",i.data=e.url,c(function(){a(t)}));for(var n in i)t[n]=i[n];for(var s in r)if(r[s]){var d=document.createElement("param");d.name=s,d.value=r[s],t.appendChild(d)}return t},l=function(e,a,i){var r=a.creatives[0],n=s(r,i);e.appendChild(n),t(e,r.creativeScript+a.customScript)},v=function(e,a,i){var r=a.creatives[0],n=r.version&&r.version<=sas.Browser.Flash.version;if(n||r.backupImage&&r.backupImage.url){var d=n?o(r,i):s(r.backupImage,i);e.appendChild(d),t(e,r.creativeScript+a.customScript)}},u={};u[sas.creativeType.REDIRECT]=n,u[sas.creativeType.IMAGE]=l,u[sas.creativeType.FLASH]=v,u[sas.creativeType.HTML5]=r;var f=function(e){var a=parseInt(1e8*Math.random()),t=2===e.oba?"top-left":"top-right";sas.utils.loadLinkCdn("diff/templates/js/adplayer/adplayer.css"),sas.utils.loadScriptCdn(["diff/templates/js/adplayer/adplayer.js","diff/templates/js/adplayer/adplayer.sas.js"],{onLoad:function(){$ADP.sas.addOba(e.formatId,!1,t,a,e.formatId,a)}})},p=function(e,a,t){var i=new sas.utils.Latch(["creaLoaded","viewabilityLoaded"]);i.addListener(function(e){sas.viewability.register(e,function(){(new Image).src=a.viewability.viewUrl},{duration:a.viewability.duration,area:a.viewability.area,onError:function(){(new Image).src=a.viewability.errorUrl}})});var r=a.creatives[0];u[r.type](e,a,function(e){i.notify("creaLoaded",e)},t),r.countUrl&&((new Image).src=r.countUrl),a.viewability&&a.viewability.enabled&&sas.utils.loadScriptCdn("diff/templates/js/sas/sas-viewability.js",{onLoad:function(){i.notify("viewabilityLoaded")}}),a.oba&&f(a)};sas.banner.render=function(t,r){if(r=r||{},r.async=null==r.async?!0:r.async,!t.creatives||!t.creatives.length)throw new Error("No creative found for config "+t.id);var n=t.creatives[0];t.tagId=i(t),e[t.id]=n;var s=document.getElementById(t.tagId);if(!s)throw new Error("No element with id "+t.tagId+" found");if(n&&!u[n.type])throw new Error("Unsupported banner type "+n.type);if(t.forcedIframeWidth>0&&t.forcedIframeHeight>0){var d=a("sas_i"+t.tagId,t.forcedIframeWidth,t.forcedIframeHeight);sas.events.addLoadEvent(d,function(){var e=d.contentDocument||d.contentWindow.document;e.body.style.margin=0,e.body.style.padding=0,p(e.body,t,r)}),s.appendChild(d)}else p(s,t,r)}}();